---
up: "[[Personal Project MoC]]"
related:
  - "[[RTSP Protocol Reversing]]"
created-date: 2025-01-24
status: todo
tags:
  - "#type/project"
  - "#type/project/vr"
---

> **Summary**:: This project is to do vulnerability research in IoT Devices like Camera, NVR, DVR, etc.

## Objective

- Recent firmware has started signing and encrypting the firmware using algorithms likes RSA-PSS and AES keys. Since the private key is protect with the vendor and the public keys is stored in the firmware this technique provides adequate protection. But still this can be bypassed. 
- If you manage get access on the shell you can the current key on the device. Replace the key with you own key and the new firmware update file can be repacked with the our key.
- We can even replace the new firmware update script with old technique and repack the firmware such that it is compatible with old firmware update service

## Tasks and Questions

- [ ]

---
## Notes

- Target is Camera, Router, NVR
- Protocols used in IP Camera
	- [RTSP - Real Time Streaming protocol](https://scapy.readthedocs.io/en/stable/api/scapy.contrib.rtsp.html)
	- open network video interface forum
	- RTMP (Real Time Messaging Protocol)
- Camera to NVR or DVR Attack surface
	- https://www.onvif.org/
- What the difference Between NVR and DVR?
	- DVR is a Digital Video Recorder, and NVR is a Network Video Recorder. Both NVRs and DVRs record video data transmitted from security cameras, storing it in a format that you can access later. They differ in how they handle that data. 
	- In a DVR system, video is recorded from analog cameras. As the name suggests, analog cameras cannot process raw video data at the source (i.e. within the camera itself). Instead, analog cameras transmit a raw video signal to the DVR along coaxial cables. The DVR processes this signal into a digital format that can then be stored and viewed remotely.
	- In an NVR system, we capture video from IP (internet protocol) cameras. Unlike analog cameras, IP cameras can process video data at the source. The processed video data is then sent to the NVR over an ethernet cable, or by wifi. IP cameras usually offer much higher resolution than analog cameras. The NVR still records data in a digital format, but it does not process the data as this has already taken place within the IP camera. 

---

## Existing Vulnerability

- https://watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html
- [How to compromise IP Camera](https://medium.com/@amansg22/compromising-cctvs-101-ecd41748c90c)

## Firmware Decryption Tools

- [Hikvision](https://github.com/HaToan/Decrypt-Firmware-Hikvision)
	- https://github.com/MatrixEditor/hiktools/
- [TP Link Decryptor](https://github.com/watchfulip/tp-link-decrypt)

## References
- https://ipcamtalk.com/threads/how-to-extract-dav-firmware-files-for-hikvision-cameras.71444/
- https://github.com/MInggongK/Hikvision-
- https://github.com/Vusal0013/Hikvision-firmwares/tree/master/Firmwares
- https://watchfulip.github.io/28-12-24/tp-link_c210_v2.html
- https://sudonull.com/post/64821-Hik-or-hack-NOT-IoT-Security-Using-Hikvision-IP-Cameras-NeoBIT-Blog
	- hikvision custom file format.

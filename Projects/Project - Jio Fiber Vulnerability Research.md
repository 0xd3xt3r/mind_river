---
up: "[[Personal Project MoC]]"
created-date: 2024-12-23
status: in-progress
tags:
  - "#type/project/personal"
---

> **Summary**:: Jio Fiber router hacking

## Tasks and Questions

- [x] #task Obtaining the firmware âœ… 2025-01-01

---
## Notes

- [JIO Fiber SIP protocol](https://github.com/JFC-Group/JF-Customisation/blob/dc24a20e56d1d93f2cd9ab99c47d6284f5f21923/Research/SIP.md)
- [Jio Research Collection](https://github.com/JFC-Group)
- [Old Firmware Binary](https://androidfilehost.com/?fid=14943124697586372879)
- [Difference Device firmware list](https://firmwarefile.com/category/jio)
- Default username - 
	- username : admin 
	- password : Jiocentrum
- Command execution primitive
	- runShellCmd
	- os.execute
- https://github.com/fawazahmed0/Jio-fiber-Modem/discussions/2
- Firmware URL
	- http://fota.slv.fxd.jiophone.net/
- match the device version of toolchain with buildroot and to compile old buildroot you need to use old build environment which can be achive by using EOL Debian like https://hub.docker.com/r/debian/eol/ this project uses this technique https://github.com/digiampietro/hacking-gemtek/tree/master/docker
- also compile same tool for crosstool-ng and debug setup was achieve for jio router

---

## Environment Setup

1. One of the main goals of setting up environment is setting up engineering/debugable  devices
2. Setting up toolchain which matches the environment of the target device.

## Building with Buildroot

- buildroot 2018.02 branch has the oldest Debian dockerfile which will let you build old branches
- building toolchain and gdb is the priority as that will help us to do target specific debugging compilation.
- `cat /proc/version` will give you toolchain and kernel version details.

``` bash
make list-defconfigs

# qemu_mipsel_malta_defconfig (Build for qemu_mipsel_malta)
make qemu_mipsel_malta_defconfig

# reset for new target
make distclean

# build
make -j$(nproc)

# to check compilation configration
gdb --configuration 

# check python support
gdb --ex "python import os"

```

### [Crosstool NG](https://crosstool-ng.github.io/docs/)

```bash

# everything is in your and not installed on your system
./configure --enable-local

make
# list all the config
ct-ng list-samples

# start building the toolchain
ct-ng build.$(nproc)

```

#### Notes


### Ghidra Debugging with GDB Remote

- gdb need to have python support
	- https://askubuntu.com/questions/513626/cannot-compile-gdb7-8-with-python-support?utm_source=chatgpt.com
- ghidra runs the python script in ghidra session to get the UI data via RMI connection.


## gdb command

```bash
# enable firewall port
/pfrm2.0/bin/iptables -I fwInBypass -p tcp --dport 8081 -m ifgroup --ifgroup-in 0x1/0x1 -j ACCEPT

set endian little
set arch mips
set sysroot ~/pdev/jio_router/binary/jcrow_414_2_57/fs/
set solib-search-path ~/pdev/jio_router/binary/jcrow_414_2_57/fs/lib
file ~/pdev/jio_router/binary/jcrow_414_2_57/fs/pfrm2.0/bin/hgw-voice-app
target remote 192.168.29.1:8081
```
 
## Command

```bash
# binwalk find offset
binwalk htrbUbNvSe.img 

# extract only sqashfs files
dd if=htrbUbNvSe.img of=pineapple.squashfs bs=1 skip=4147372

# extract squash file-system
unsquashfs -f -d tmp_dir/ ./pineapple.squashfs

# encrypt the config
openssl aes-128-cbc -pass file:key.txt -in RSTOTJIPE039095_JCOW414.txt -out RSTOTJIPE039095_JCOW414.enc 

# new device config encryption
openssl aes-128-cbc -pass file:key_jcro4032.txt -in /home/hussain/Downloads/RSTOTEKC0007195_JCO4032.txt -out /home/hussain/Downloads/RSTOTEKC0007195_JCO4032.enc

config.userdb = {} os.execute("/usr/sbin/telnetd"); os.execute("/pfrm2.0/bin/iptables -I fwInBypass -p tcp --dport 23 -m ifgroup --ifgroup-in 0x1/0x1 -j ACCEPT"); os.execute("echo -e \"password\npassword\" | passwd root");


./target/usr/bin/gdbserver --multi :8081 --attach $(pidof hgw-voice-app)
sudo netstat -tulnp | grep :<port_number>
```

```bash
RIL> gponmgr get info
ONU Info:
 ONU ID:    81
 ONU State: O5
 SN:        SCOMa6133f0e
 PASSWD:
  ASCII:    00000001
  HEX:      30303030303030310000
 REGID:
  ASCII:    
  HEX:      000000000000000000000000000000000000000000000000000000000000000000000000
 Key Idx:   1
 Key:       6d4231e7bef99365fa8cabb23112be24
 O1 Timer:  10000 ms
 O2 Timer:  100 ms
 OMCC ID:   51
```

### Using MIPS emulator

```bash

# install qemu-static
sudo apt-get install qemu-user-static

# start root shell in qemu in chroot
sudo chroot <squashfs_root_dir> /usr/bin/qemu-mipsel-static /bin/sh -i

# start lua interpreter
LD_LIBRARY_PATH=/usr/lib:/usr/local/lib ./pfrm2.0/bin/lua

# use any program binary
LD_LIBRARY_PATH=/usr/lib:/usr/local/lib ./pfrm2.0/bin/usrKlite
```

## Attack Surface

1. MQTT Lib Paho
1. VoIP
	1. pfrm2.0/bin/hgw-voice-app
		1. this uses websocket library: https://github.com/warmcat/libwebsockets
			1. https://libwebsockets.org/git/libwebsockets/tree/READMEs/README.html-parser.md
	2. pfrm2.0/lib/libims.so

## Software Components 

- Toolchain : 
	- GCC: (GNU) 3.3.2
	- (Buildroot 2015.08.1) 4.6.3
	- Linux version 3.18.21 (root@tn33) (gcc version 4.6.3 (Buildroot 2015.08.1) ) #6 SMP Mon Jul 22 12:26:15 IST 2024
- https://github.com/resiprocate/resiprocate - SIP Call protocol implementation
	- [OSS Fuzz Report](https://introspector.oss-fuzz.com/project-profile?project=resiprocate)
	- https://github.com/google/oss-fuzz/tree/master/projects/resiprocate
		- https://github.com/resiprocate/resiprocate/blob/master/resip/stack/test/fuzzStack.cxx
		- https://github.com/resiprocate/resiprocate/blob/master/rutil/test/fuzzUtil.cxx
- https://github.com/warmcat/libwebsockets - websocket
	- https://github.com/google/oss-fuzz/tree/master/projects/libwebsockets

### Building Reciprocate

1. file `build/jenkins/ubuntu/Dockerfile` has list of dependencies to install before compiling
2. Compilation command 
```bash
cmake -S . -B _build_new -DBUILD_TFM=OFF
cmake --build _build_new/
```


## Open source fuzzing Projects

1. https://voiper.sourceforge.net/
2. https://code.google.com/archive/p/sipfuzzer/downloads

## Hardware

### JCO4032 - Latest

> Active home connection

- Current Version : SRCMTF1_JCO4032_R2.57
- Default password : ohNgeivoh0Guf5to
- Root access
	- Its still there, just commented out. If you right click on "Factory Default settings" and choose inspect, your browser's developer console will open. In the developer console, you will see the commented form for backup and restore functionality. To bring it back, right click on the commented block and choose edit as html. Then remove \<!-- from front of the block and --> from the end of the block.
	- If you need to use restore functionality, the restore form has a hidden field called thispage which is set to backupRestore.html. Change that to factoryDefault.html.

### JCOW414 - Old Model

> The device which Jio didn't collect from me.

1. Version Binary available
	1. SRCMTF1_JCOW414_R2.15.img
	2. SRCMTF1_JCOW414_R2.35.img
	3. SRCMTF1_JCOW414_R2.39.img
	4. SRCMTF1_JCOW414_R2.41.img
	5. SRCMTF1_JCOW414_R2.45.img
	6. SRCMTF1_JCOW414_R2.52.1.img
2. Current Firmware 
	1. Version : SRCMTF1_JCOW414_R2.52.1
	2. Date : Tue Oct 17 15:45:55 IST 2023
3. Latest Firmware
	1. JioFiber JCOW414 ONT R2.57 firmware files OTA URLs:
		1. FW_img: http://fota.slv.kai.jiophone.net/XPGNO/DIN225/S414W_257/htrbUbNvSe.img
		2. FW_sig: http://fota.slv.kai.jiophone.net/XPGNO/DIN225/S414W_257/htrbUbNvSe.sig

#### Chipset Datasheet

- Econet EN7571N, IC DRIVER SQFN-28 2.5Gb/s BURST MODE LASER TRANSCEIVER
- MT7592N, abgn 2x2:2 rebranding of Ralink RT5592EP
- MT7613ben, 2x2:2, an+ac (also used by tplink c6/a6 v3)
- econet 7528, MIPS 1004kc dual-core, Clock rate: 900Mhz, Chuangfa Technology is a leading global broadband communications chip manufacturer. It was independent from MediaTek in 2013 and is a subsidiary of MediaTek. This SoC seems to be xPON compatible.
- ESMT M15T4G16256A, 512 MB DDR3(L) RAM, https://www.esmt.com.tw/upload/pdf/ESMT/datasheets/M15T4G16256A(2G).pdf, https://esmt.com.tw/upload/pdf/ESMT/datasheets/M15T4G16256A(2L).pdf
- ESMT f50l2g41xa, 256 MB Flash, https://www.esmt.com.tw/upload/pdf/ESMT/datasheets/F50L2G41XA(2B).pdf
- p61089l, High Voltage Ringing SLIC Protector.
- msc le9643, Subscriber Line Interface Circuit, https://www.microsemi.com/document-portal/doc_download/137164-le9643-le9653-product-brief

---
## References

- [Project Zero Research on WebRTC & SDP](https://googleprojectzero.blogspot.com/2021/01/the-state-of-state-machines.html)
	- JioChat was one of the target.
- [Blackhat talk](https://www.blackhat.com/presentations/bh-jp-05/bh-jp-05-nuwere.pdf)
- https://www.nanibot.net/posts/jio-notes/
- https://yashgarg.dev/notes/jiofiber-bits
- https://www.artresilia.com/iot-series-iv-debugging-with-gdb-ghidra-zero-day/
- https://github.com/digiampietro/hacking-gemtek
- https://hacktivity.com/events/iot-reverse-engineering-attaching-a-gnu-debugger-to-a-live-iot-system/
- https://blog.quarkslab.com/leveraging-sourcetrail-to-a-mapping-tool-meet-numbat-and-pyrrha.html

---
tags:
  - "#qpsi/project"
  - "#type/sub-project"
  - "#status/active"
status: abandoned
up: "[[Android Kernel Driver Fuzzing|Linux Kernel Fuzzing]]"
related: 
created-date: 2024-12-15
summary: Fuzzing WiFi Router with syzkaller
---


> **Summary**:: 


## Meetings

```dataview
TABLE WITHOUT ID
	file.link as "Session",
	up, created-date, participants, summary, tags
FROM !"Templates"
WHERE icontains(related, this.file.link)
AND icontains(tags, "type/meeting")
SORT file.link DESC
```

## Tasks and Questions

```dataview
TASK
WHERE icontains(text, this.file.name)
AND (icontains(tags, "#task") OR icontains(text, "#questions"))
AND !completed
GROUP BY file.name as filename
SORT filename DESC
```

> **Summary**:: 

## Meetings

```dataview
TABLE WITHOUT ID
	file.link as "Session",
	up, created-date, participants, summary, tags
FROM !"Templates"
WHERE icontains(related, this.file.link)
AND icontains(tags, "type/meeting")
SORT filename DESC
```

## Tasks and Questions

```dataview
TASK
WHERE icontains(text, this.file.name)
AND (icontains(tags, "#task") OR icontains(text, "#questions"))
AND !done
GROUP BY file.name as filename
SORT filename DESC
```

## Notes
## WIN 7 - Vulnerability Detection

PoC - Manikandan Mohan


IP : 10.201.65.163
usr: qctest
pwd: t-span123

## Notes

- https://confluence.qualcomm.com/confluence/pages/viewpage.action?pageId=845403182
- https://confluence.qualcomm.com/confluence/display/WIFISEC/Code+Review+progress+tracking

## Attack Surface

1. Mesh Network
	1. Automatic config synchronization
	2. traffic isolation
	3. mshelia@hu-mshelia-hyd:/local/mnt/workspace/qcom-dev/win7/qsdk/qca/src/qca-wsplcd

### Modules

#### ezmesh
1. mapConfigSocketRxEAPOL
2. mapConfigAgentHandleDPPEapolSocketFrames
3. mapConfigCtrlHandleDPPEapolSocketFrames
4. tds1905EventTopologyCB
5. tds1905MessageHandler

#### wsplcd
- apacHyfi20SendL2Packet
- apacHyfi20GetIEEE1905PktCB
- apacHyfi20ReceiveWps
- apacHyfi20ReceiveRenewalE
- apacHyfi20ReceiveWpsE
- wps_parse_wps_data
- apacHyfi20ReceiveWpsR
	- problem the tlv_length field is not sanitized
- apacHyfi20ReceiveResponseE
	- problem the tlv_length field is not sanitized due with all the math operation done with it can have integer wrap around.
- apacHyfi20SendSearchE
- apacHyfiParse1905TLV
	- issue 1 : `2549 accumulatedLen = ieee1905TLVLenGet(TLV) + IEEE1905_TLV_MIN_LEN;`  ieee1905TLVLenGet(TLV) is controlled by user
	- length of all the memcpy and malloc is controlled by user


Root AP -> Controller/[R]/Reegister
Repeater AP -> Agent/[E]nrollee

## Meeting Notes

### 19-10-2022

#### Agenda
- [ ] Code Review

#### Notes and Decisions
- 

#### Action Items
-

---

### Bugs

1. Line 3265 and 3270
	1. ![[Pasted image 20220516195111.png]]
2. line 3307 and 3312
	1. ![[Pasted image 20220516195249.png]]
3. Line 3351 and 3352
	1. ![[Pasted image 20220516195318.png]]
4. Line 1921
	1. ![[Pasted image 20220516195508.png]]
5. Line 2399
	1. ![[Pasted image 20220516195537.png]]
6. Line 2494
	1. ![[Pasted image 20220516195602.png]]
7. How is data for this function validated?
	1. ![[Pasted image 20220516195944.png]]
	2. for all these function copy_to_user len parameter is not validated
8. line 3336 and 3351
	1. ![[Pasted image 20220516222602.png]]
9. 
	```C
		int32_t ucfg_atf_show_group(struct wlan_objmgr_vdev *vdev,
			struct atfgrouptable *buf)
		{
			uint32_t i = 0, k = 0;
		
		
			for (i = 0; i < cfg->grp_num_cfg; i++) {
				qdf_mem_copy(buf->atf_groups[buf->info_cnt].grpname,
				cfg->atfgroup[i].grpname, WLAN_SSID_MAX_LEN);
		}
		
		// -----------------------
			int32_t ucfg_atf_show_subgroup(struct wlan_objmgr_vdev *vdev,
						       struct atfgrouplist_table *buf)
			{
				
				qdf_list_peek_front(&pa->atf_groups, &node);
				while (node) {
				    i = 0;
				    // buf is controlled by user and so is info_cnt
				    k = buf->info_cnt;
					group = qdf_container_of(node, struct atf_group_list,
								 group_next);
					next_node = NULL;
	
	```
10. 
	```C
		#if UMAC_SUPPORT_RRM
		static int
		ieee80211dbg_ioctl_neighrpt(wlan_if_t vap, struct ieee80211req_athdbg *req)
		{
		    ieee80211_user_nrresp_info_t nrrpt_user;
		    ieee80211_cust_nrresp_info_t *nrresp = NULL;
		    int retv = 0;
		
		    if (copy_from_user(&nrrpt_user, (ieee80211_user_nrresp_info_t *) req->data.neighrpt_custom,
		                                                sizeof(ieee80211_user_nrresp_info_t))) {
		       qdf_err("Copy from user failed ");
		       return -EFAULT;
		    }
		    // this is controlled by user and it the only check which is done is for
		    // non zero value
		    if (!nrrpt_user.num_report) {
		        qdf_err("Number of reports cannot be zero");
		        return -EINVAL;
		    }
	```
11. 
```C
int32_t ucfg_atf_get_lists(struct wlan_objmgr_vdev *vdev,
			   struct atfgrouplist_table *buf)
{
	struct pdev_atf *pa = NULL;
	struct atf_group_list *group = NULL;
	struct atf_subgroup_list *subgroup = NULL;
	qdf_list_node_t *node = NULL, *next_node = NULL;
	qdf_list_node_t *tmpnode = NULL, *tmpnode_next = NULL;
	int8_t i = 0, k = 0;

	if (NULL == vdev) {
		atf_err("Vdev is NULL\n");
		return -1;
	}
	pa = atf_get_pdev_atf_from_vdev(vdev);
	if (NULL == pa) {
		atf_err("pdev atf is NULL\n");
		return -1;
	}
	qdf_list_peek_front(&pa->atf_groups, &node);
	while (node) {
		group = qdf_container_of(node, struct atf_group_list,
					 group_next);
		next_node = NULL;
		qdf_list_peek_next(&pa->atf_groups, node, &next_node);
		if (group) {
			// info count not validate its controlled by user
			k = buf->info_cnt;
			// memcpy is problem in kernel
			OS_MEMCPY((char *)(buf->atf_list[k].grpname),
						  (char *)group->group_name, WLAN_SSID_MAX_LEN);
```